3단계-구간 추가 기능
===
# 미션 설명
### 기능 요구사항
- `요구사항 설명`에서 제공되는 요구사항을 기반으로 지하철 구간 추가 기능을 구현하세요.
- 요구사항을 정의한 인수 조건을 조출하세요.
- 인수 조건을 검증하는 인수 테스트를 작성하세요.
- 예외 케이스에 대한 검증도 포함하세요.

### 프로그래밍 요구사항
- 인수 테스트 주도 개발 프로세스에 맞춰서 기능을 구현하세요.
  - `요구사항 설명`을 참고하여 인수 조건을 정의
  - 인수 조건을 검증하는 인수 테스트 작성
  - 인수 테스트를 충족하는 기능 구현
- 인수 조건은 인수 테스트 메서드 상단에 주석으로 작성하세요.
  - 뼈대 코드의 인수 테스트를 참고
- 인수 테스트의 결과가 다른 인수 테스트에 영향을 끼치지 않도록 인수 테스트를 서로 격리 시키세요.
- 인수 테스트의 재사용성과 가독성, 그리고 빠른 테스트 의도 파악을 위해 인수 테스트를 리팩터링 하세요.

### 요구사항 설명 : 인수 조건
구간 등록 API Request
```
POST /lines/1/sections HTTP/1.1
accept: */*
content-type: application/json; charset=UTF-8
host: localhost:52165

{
    "downStationId": "4",
    "upStationId": "2",
    "distance": 10
}
```

지하철 구간 등록 인수 테스트 작성과 기능 구현
[ ] 역 사이에 새로운 역을 등록할 경우
  - 새로운 길이를 뺀 나머지를 새롭게 추가된 역과의 길이로 설정
[ ] 새로운 역을 상행 종점으로 등록할 경우
[ ] 새로운 역을 하행 종점으로 등록할 경우

구간 등록시 예외 케이스를 고려하기
  - [ ] 역 사이에 새로운 역을 등록할 경우 기존 역 사이 길이보다 크거나 같으면 등록을 할 수 없음
  - [ ] 상행역과 하행역이 이미 노선에 모두 등록되어 있다면 추가할 수 없음
  - [ ] 상행역과 하행역 둘 중 하나도 포함되어있지 않으면 추가할 수 없음


### 힌트
- @BeforeEach 구문에서 테스트 조건을 생성하여 각 테스트의 Given 절에 대한 중복 코드 제거
---

### 구현 기능 목록
- [ ] 노선과 역의 N:M 연관관계를 매핑 테이블 객체를 추가하여 1:N, M:1 관계로 정의
- [ ] 구간에 대한 Entity 설계
  - 노선과 구간에 대한 일대다 연관관계 설정
- [ ] `@Embedded/@Embeddable`을 활용한 일급 컬렉션 필드 적용
- [ ] 구간 등록 요청/응답 객체 설계
- [ ] 구간 추가 API에 대한 인수테스트 작성
- [ ] 예외 케이스에 대한 인수테스트 작성

### 리팩토링 목록
- [ ] 한글 표현, TC에 중복으로 사용되는 생성부의 가독성 향상
- [ ] 인수테스트 가독성 향상을 위해 검증부를 한글로 표현된 별도의 메소드로 추출

---

### 3주차 인수 테스트 주도 개발 영상 내용 정리
- 각 인수 테스트 수행 환경을 격리
  - EntityManager를 이용한 turncate를 이용하여 tearDonw 진행
- 테스트 중복 제거
  - 각 TC에 반복적으로 수행되는 생성부 추출 하기
- 테스트 의도 표현
   - 테스트의 각 스텝을 한글 메서드로 표현하여 의도를 명확히 드러내기
- 인수 조건을 테스트로 옮기기
Feature 기준으로 인수테스트 클래스를 분리
Scenario 기준으로 인수테스트 메서드를 분리
Feature 내부에 있는 Scenario는 같은 텍스트 픽스쳐를 공유
```
given: 지하철 역 등록 request 보내기
when: 지하철역 삭제 reqeust 보내기
then: 지하철역 삭제를 확인하기
- 지하철 역 삭제 요청의 응답 코드로 확인
- 지하철 역 조회 request 후 response 값에서 확인
```
- 테스트 코드 작성 팁
  - 간단한 성공 케이스 우선 작성
  - 기능 제공에서 발생 가능한 실패 케이스 작성
  - When > Then > Given 순으로 작성
